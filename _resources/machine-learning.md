---
layout: collection
title: Machine Learning in R and Python
---

<!-- TOC depthFrom:1 depthTo:6 withLinks:1 updateOnSave:1 orderedList:0 -->

	- [Overview](#overview)
	- [Resources](#resources)
	- [Saved Searches](#saved-searches)
	- [Books](#books)
		- [Books - Machine Learning for Forecasting Time Series](#books-machine-learning-for-forecasting-time-series)
		- [Books - Other Types of Machine Learning](#books-other-types-of-machine-learning)
	- [Articles](#articles)
		- [Basics of Machine Learning](#basics-of-machine-learning)
		- [TensorFlow](#tensorflow)
		- [Long-Short Term Memory (LSTM)](#long-short-term-memory-lstm)
			- [LSTM Basics](#lstm-basics)
			- [LSTM Code & examples](#lstm-code-examples)
			- [LSTM - Articles and Papers](#lstm-articles-and-papers)
		- [Time Series Forecasting](#time-series-forecasting)
		- [Temporal Convolutional Networks (TCN)](#temporal-convolutional-networks-tcn)
		- [Train-Test-Validation Split](#train-test-validation-split)
		- [Getting Data](#getting-data)
		- [Amazon Services (AWS)](#amazon-services-aws)
		- [Machine Learning in Sports Betting](#machine-learning-in-sports-betting)

<!-- /TOC -->

## Overview

## Resources

* **CRAN Task View: Machine Learning & Statistical Learning**
  * [Link](https://cran.r-project.org/web/views/MachineLearning.html)
* **Tensorflow for R - R Studio**
  * [Guide](https://tensorflow.rstudio.com/guide/)
  * [Tutorials](https://tensorflow.rstudio.com/tutorials/)
  * [Learning Resources](https://tensorflow.rstudio.com/learn/resources/)
* **Keras for R**
  * [Link](https://keras.rstudio.com/)
* **Cheatsheets**
  * [Time Series Cheat Sheet](https://github.com/rstudio/cheatsheets/blob/main/time-series.pdf) - [DB](https://www.dropbox.com/s/vk7r1jq5y7upqrp/time-series-forecasting-R-cheatsheet.pdf?dl=0)
  * [Keras for R - Cheat Sheet](https://github.com/rstudio/cheatsheets/blob/main/keras.pdf) - [DB](https://www.dropbox.com/s/3reyf8w4jawzfmo/keras-R-cheatsheet.pdf?dl=0)
* **Keras**
  * [Link](https://keras.io/)

## Saved Searches

* "lstm time series stock market"
  * [ScienceDirect](https://www.sciencedirect.com/search?qs=lstm%20time%20series%20stock%20market) - [Google Scholar](https://scholar.google.com/scholar?hl=en&as_sdt=0%2C5&q=lstm+time+series+stock+market)
* "arima time series stock market"
  * [SD](https://www.sciencedirect.com/search?qs=arima%20time%20series%20stock%20market) - [GS]()

## Books

### Books - Machine Learning for Forecasting Time Series

* **Hands on Machine Learning for Algorithmic Trading**

  * [Google Books](https://www.google.com/books/edition/Hands_On_Machine_Learning_for_Algorithmi/tx2CDwAAQBAJ?hl=en&gbpv=0&kptab=overview)
  * **Summary** Explore effective trading strategies in real-world markets using NumPy, spaCy, pandas, scikit-learn, and Keras

* **Machine Learning for Algorithmic Trading**

  * [Google Books](https://www.google.com/books/edition/Machine_Learning_for_Algorithmic_Trading/cki6zQEACAAJ?hl=en)
  * **Summary** Leverage machine learning to design and back-test automated trading strategies for real-world markets using pandas, TA-Lib, scikit-learn, LightGBM, SpaCy, Gensim, TensorFlow 2, Zipline, backtrader, Alphalens, and pyfolio.

* **Forecasting: Principles and Practice, 3rd Edition**

  * [Online Text](https://otexts.com/fpp3/)

* **Advanced Forecasting with Python**

  * [Google Books](https://www.google.com/books/edition/Advanced_Forecasting_with_Python/s4xqzgEACAAJ?hl=en)
  * **Summary:** Covers state-of-the-art-models including LSTMs, Facebook’s Prophet, and Amazon’s DeepAR. Includes an exhaustive overview of models relevant to forecasting. Provides intuitive explanations, mathematical background, and applied examples in Python for each of the 18 models covered
  * [Github Repo for Chapters from Advanced Forecasting with Python](https://github.com/Apress/advanced-forecasting-python)
* **Hands-On Machine Learning with R**
  * [Online Text](https://bradleyboehmke.github.io/HOML/)
  * [Google Books](https://www.google.com/books/edition/Hands_On_Machine_Learning_with_R/aXC9DwAAQBAJ?hl=en&gbpv=0)
  * **Summary:** "a practitioner’s guide to the machine learning process and a place where one can come to learn about the approach and to gain intuition about the many commonly used, modern, and powerful methods accepted in the machine learning community."

* **Deep Learning with R, 2nd Edition**

  * [Google Books](https://www.google.com/books/edition/Deep_Learning_with_R_Second_Edition/ADs3zwEACAAJ?hl=en)
  * Deep Learning with R introduces the world of deep learning using the powerful Keras library and its R language interface. The book builds your understanding of deep learning through intuitive explanations and practical examples.

* **Machine Learning with R: Expert Techniques for Predictive Modeling, 3rd Edition**

  * [Google Books](https://www.google.com/books/edition/Machine_Learning_with_R/iNuSDwAAQBAJ?hl=en&gbpv=0)
* **Hands-On Deep Learning with R**
  * [Google Books](https://www.google.com/books/edition/Hands_On_Deep_Learning_with_R/giDgDwAAQBAJ?hl=en&gbpv=0&kptab=overview)

* **Hands-On Machine Learning with Scikit-Learn, Keras, and TensorFlow, 2nd Edition**

  * [Google Books](https://www.google.com/books/edition/Hands_On_Machine_Learning_with_Scikit_Le/HnetDwAAQBAJ?hl=en&gbpv=0)

### Books - Other Types of Machine Learning

* **Supervised Machine Learning for Text Analysis in R**

  * [Online Text](https://smltar.com/)

## Articles

### Basics of Machine Learning

* **Deep Learning for Time Series Forecasting: Tutorial and Literature Survey**

  * [Link](https://assets.amazon.science/b5/42/c1fe37c8403f91a0d85d55eb85f4/deep-learning-for-time-series-forecasting-tutorial-and-literature-survey.pdf) - [DB](https://www.dropbox.com/s/hc94o16vaiuz6o1/deep-learning-for-time-series-forecasting-tutorial-and-literature-survey.pdf?dl=0)

### TensorFlow

* **Tensor Flow Tutorial - Time Series Forecasting**

  * [Link](https://www.tensorflow.org/tutorials/structured_data/time_series) - [DB](https://www.dropbox.com/s/9axtgsirkf0qrf7/2022.07.07-time_series.pdf?dl=0)

* **How to Predict New Samples with Your Keras Model**

  * [Link](https://github.com/christianversloot/machine-learning-articles/blob/main/how-to-predict-new-samples-with-your-keras-model.md) - [DB](https://www.dropbox.com/s/ogjbg7eh3j8d39a/2022.07.07-how-to-predict-new-samples-with-your-keras-model.md.pdf?dl=0)

* **Time Series Forecasting with TensorFlow, ARIMA, and PROPHET**

  * [Link](https://polzinben.github.io/Time-Series-Forecasting/) - [DB](https://www.dropbox.com/s/m3blt6b3d3755nf/Time%20Series%20Forecasting%20with%20TensorFlow%2C%20ARIMA%2C%20and%20PROPHET%20%286-min%20read%29%20%E2%80%93%20Ben%20Polzin%20%E2%80%93%20Engineer%20_%20Data%20Scientist%20_%20Machine%20Learning%20_%20Passionate%2C%20Data-Driven%2C%20and%20Future-Focused.pdf?dl=0)
  * [Github Repo](https://github.com/polzinben/Time-Series-Forecasting/blob/main/colab_notebooks/retail_sales_forecasting.ipynb)

#### Tensorflow For R

* Introduction to Tensors
	* [Link](https://keras.rstudio.com/guides/tensorflow/tensor) -

### Long-Short Term Memory (LSTM)

#### LSTM Basics

* **Understanding LSTM Networks**

  * **Summary** A visual and simple guide to understanding LSTM networks. Beautifully structured and easy to understand. Start here if you are new to LSTM.
  * [Link](http://colah.github.io/posts/2015-08-Understanding-LSTMs/) - [DB](https://www.dropbox.com/s/9cvoo16dj0brhru/Understanding%20LSTM%20Networks%20--%20colah%27s%20blog.pdf?dl=0)

* **Time Series Forecasting with the Long Short-Term Memory Network in Python**

  * **Summary** From Machine Learning Mastery blog, a great post on putting together a Python model for time series forecasting using LSTM.
  * [Link](https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/) - [DB](https://www.dropbox.com/s/fa2vhdyw7gqvwgh/Time%20Series%20Forecasting%20with%20the%20Long%20Short-Term%20Memory%20Network%20in%20Python.pdf?dl=0)

* **Multi-Step LSTM Time Series Forecasting Models for Power Usage**

  * **Summary:** In this tutorial, you will discover how to develop long short-term memory recurrent neural networks for multi-step time series forecasting of household power consumption. After completing this tutorial, you will know:
    * How to develop and evaluate Univariate and multivariate Encoder-Decoder LSTMs for multi-step time series forecasting.
    * How to develop and evaluate an CNN-LSTM Encoder-Decoder model for multi-step time series forecasting.
    * How to develop and evaluate a ConvLSTM Encoder-Decoder model for multi-step time series forecasting.
  * [Link](https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/) - [DB](https://www.dropbox.com/s/i2x68w37nfjxzou/2022.07.07-how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption.pdf?dl=0)

* **Time Series Forecasting — ARIMA, LSTM, Prophet with Python**

  * **Summary** In this article we will try to forecast a time series data basically. We’ll build three different model with Python and inspect their results. Models we will use are ARIMA (Autoregressive Integrated Moving Average), LSTM (Long Short Term Memory Neural Network) and Facebook Prophet.
  * [Link](https://medium.com/@cdabakoglu/time-series-forecasting-arima-lstm-prophet-with-python-e73a750a9887) - [DB](https://www.dropbox.com/s/2illdufnut1wnsl/2022.07.07-time-series-forecasting-arima-lstm-prophet-with-python-e73a750a9887.pdf?dl=0)

* **Build an LSTM Model with TensorFlow 2.0 and Keras**

  * [Link](https://github.com/christianversloot/machine-learning-articles/blob/main/build-an-lstm-model-with-tensorflow-and-keras.md) - [DB](https://www.dropbox.com/s/oebzg94meya83pn/machine-learning-articles_build-an-lstm-model-with-tensorflow-and-keras.md%20at%20main%20%C2%B7%20christianversloot_machine-learning-articles%20%C2%B7%20GitHub.pdf?dl=0)

* **ARIMA vs Prophet vs LSTM for Time Series Prediction**

  * [Link](https://neptune.ai/blog/arima-vs-prophet-vs-lstm) - [DB]()

#### LSTM Code & examples

* **LSTM in Tensorflow for Times Series forecasting**

  * [Github Repo](https://github.com/NioushaR/LSTM-TensorFlow-for-Timeseries-forecasting/blob/master/Time%20series.ipynb) - [DB](https://www.dropbox.com/s/f409k8rcpp5sgt1/2022.07.07-Time%2520series.ipynb.pdf?dl=0)

* **Time Series Forecasting using LSTM in R · Richard Wanjohi, Ph.D**

  * [Github Repo](http://rwanjohi.rbind.io/2018/04/05/time-series-forecasting-using-lstm-in-r/)

* **Chapter 9 of SUpervised Machine Learning for Text Analysis in R - Long short-term memory (LSTM) networks - Supervised Machine Learning for Text Analysis in R**

  * [Link](https://smltar.com/dllstm.html)

#### LSTM - Articles and Papers

* **A Comparison of ARIMA and LSTM in Forecasting Time Series**

  * **Summary** The empirical studies conducted and reported in this article show that deep learning-based algorithms such as LSTM outperform traditional-based algorithms such as ARIMA model. More specifically, the average reduction in error rates obtained by LSTM was between 84 - 87 percent when compared to ARIMA indicating the superiority of LSTM to ARIMA.
  * [Link](https://par.nsf.gov/servlets/purl/10186768) - [DB](https://www.dropbox.com/s/xs4o5gpu9h09no1/A%20Comparison%20of%20ARIMA%20and%20LSTM%20in%20Forecasting%20Time%20Series.pdf?dl=0)

* **Predictive Analytics: Time-Series Forecasting with GRU and BiLSTM in TensorFlow**

  * **Summary** A step-by-step tutorial on building GRU and Bidirectional LSTM for Time-series forecasting.
  * [Link](https://towardsdatascience.com/predictive-analytics-time-series-forecasting-with-gru-and-bilstm-in-tensorflow-87588c852915) - [DB](https://www.dropbox.com/s/n5191r14hjxicjt/2022.07.07-predictive-analytics-time-series-forecasting-with-gru-and-bilstm-in-tensorflow-87588c852915.pdf?dl=0)

* **[Paper] Deep learning based models: Basic LSTM, Bi LSTM, Stacked LSTM, CNN LSTM and Conv LSTM to forecast Agricultural commodities prices**

  * **Summary** The literature argues that an accurate price prediction of agricultural goods is a quintessence to assure a good functioning of the economy all over the world. Research reveals that studies with application of deep learning in the tasks of agricultural price forecast on short historical agricultural prices data are very scarce and insist on the use of different methods of deep learning to predict and to this reaction of filling the gap, this study employs five versions of LSTM deep learning techniques for the task of five agricultural commodities prices prediction on univariate time series dataset of Rice, Wheat, Gram, Banana, and Groundnut spanning January 2000 to July 2020.
  * [Link](https://www.researchsquare.com/article/rs-740568/v1) - [DB](https://www.dropbox.com/s/ly9q2xq030v4gjl/Deep%20learning%20based%20models-%20Basic%20LSTM%2C%20Bi%20LSTM%2C%20Stacked%20LSTM%2C%20CNN%20LSTM%20and%20Conv%20LSTM%20to%20forecast%20Agricultural%20commodities%20prices.pdf?dl=0)

* **[Paper] Applying LSTM to time series predictable through time-window approaches.**

  * **Summary** Long Short-Term Memory (LSTM) is able to solve many time series tasks unsolvable by feed-forward networks using fixed size time windows. Here we find that LSTM’s superiority does not carry over to certain simpler time series prediction tasks solvable by time window approaches: the Mackey-Glass series and the Santa Fe FIR laser emission series (Set A). This suggests to use LSTM only when simpler traditional approaches fail.
  * [Link](https://link.springer.com/chapter/10.1007/978-1-4471-0219-9_20)

* **[Paper] Optimizing LSTM for time series prediction in Indian stock market**

  * **Summary** Long Short Term Memory (LSTM) is among the most popular deep learning models used today. It is also being applied to time series prediction which is a particularly hard problem to solve due to the presence of long term trend, seasonal and cyclical fluctuations and random noise. The performance of LSTM is highly dependent on choice of several hyper-parameters which need to be chosen very carefully, in order to get good results. Being a relatively new model, there are no established guidelines for configuring LSTM. In this paper this research gap was addressed. A dataset was created from the Indian stock market and an LSTM model was developed for it. It was then optimized by comparing stateless and stateful models and by tuning for the number of hidden layers.
  * [Link](https://www.sciencedirect.com/science/article/pii/S1877050920307237) - [DB](https://www.dropbox.com/s/vrg1p2mnjnylkhz/Optimizing%20LSTM%20for%20time%20series%20prediction%20in%20Indian%20stock%20market.html?dl=0)

### Time Series Forecasting

* **Three Part Series on Time Series Analysis**

  * [GitHub Repo of all 3 Parts](https://github.com/ogulcanertunc/Time-Series)
  * Part 1: Introduction to Time Series
    * [Link](https://medium.com/analytics-vidhya/1-introduction-to-time-series-5ae663c468f4) - [DB](https://www.dropbox.com/s/vsmykh1cxytdvey/2022.06.28-1-introduction-to-time-series-5ae663c468f4.pdf?dl=0)
  * Part 2: Econometric & Statistical Models in Time Series
    * [Link](https://medium.com/analytics-vidhya/2-econometric-statistical-models-in-time-series-7b69ae3ab1d8) - [DB](https://www.dropbox.com/s/754iukmznzw294o/2022.06.28-2-econometric-statistical-models-in-time-series-7b69ae3ab1d8.pdf?dl=0)
  * Part 3: Time Series Forecasting Using LSTM
    * [Link](https://medium.com/analytics-vidhya/3-time-series-forecasting-using-lstm-e14b93f4ec7c) - [DB](https://www.dropbox.com/s/gl5ryqxhtzo7if5/2022.06.28-3-time-series-forecasting-using-lstm-e14b93f4ec7c.pdf?dl=0)

* **Univariate Time Series Analysis and Forecasting with ARIMA/SARIMA**

  * **Summary** In this tutorial, we will be dealing with univariate time series modeling. We will first discuss a few concepts in ARIMA and Seasonal ARIMA models. We will then practically implement the ARIMA and Seasonal ARIMA models.
  * [Link](https://www.section.io/engineering-education/univariate-time-series-analysis-with-arima-in-python/) - [DB](https://www.dropbox.com/s/8falt3r31ieyonb/2022.07.07-univariate-time-series-analysis-with-arima-in-python.pdf?dl=0)

#### Iterated vs Direct Time Series Forecast

* **A comparison of direct and iterated multistep AR methods for forecasting macroeconomic time series**

	* [Link](https://www.princeton.edu/~mwatson/papers/Marcellino_Stock_Watson_JoE_2006.pdf) - [DB](https://www.dropbox.com/s/ui3rzqmt0jjkiqc/Marcellino_Stock_Watson_JoE_2006.pdf?dl=0)
	* **Summary** Iterated multiperiod-ahead time series forecasts are made using a one-period ahead model, iterated forward for the desired number of periods, whereas direct forecasts are made using a horizon-specific estimated model, where the dependent variable is the multiperiod ahead value being forecasted. The iterated forecasts typically outperform the direct forecasts, particularly, if the models can select long-lag specifications. The relative performance of the iterated forecasts improves with the forecast horizon.

* **4 Strategies for Multi-Step Time Series Forecasting**

	* [Link](https://machinelearningmastery.com/multi-step-time-series-forecasting/) - [DB](https://www.dropbox.com/s/5viej8zfj9bee0q/4%20Strategies%20for%20Multi-Step%20Time%20Series%20Forecasting.pdf?dl=0)
	* **Summary** In this post, you will discover the four main strategies for multi-step time series forecasting. After reading this post, you will know: The difference between one-step and multiple-step time series forecasts. The traditional direct and recursive strategies for multi-step forecasting. The newer direct-recursive hybrid and multiple output strategies for multi-step forecasting.

* **Recursive and direct multi-step forecasting: the best of both worlds**

	* [Link](https://robjhyndman.com/papers/rectify.pdf) - [DB](https://www.dropbox.com/s/qkv2c3wofaf6axd/Recursive%20and%20direct%20multi-step%20forecasting-%20the%20best%20of%20both%20worlds.pdf?dl=0)
	* **Summary** We propose a new forecasting strategy, called rectify, that seeks to combine the best properties of both the recursive and direct forecasting strategies. We find that the rectify strategy is always better than, or at least has comparable performance to, the best of the recursive and the direct strategies.

* **Machine Learning Strategies for Time Series Forecasting**

	* [Link](https://www.researchgate.net/publication/236941795_Machine_Learning_Strategies_for_Time_Series_Forecasting) - [DB](https://www.dropbox.com/s/bv0c76h7r5ax6eb/Machine%20Learning%20Strategies%20for%20Time%20Series%20Forecasting.pdf?dl=0)
	* **Summary** This chapter presents an overview of machine learning techniques in time series forecasting by focusing on three aspects: the formalization of one-step forecasting problems as supervised learning tasks, the discussion of local learning techniques as an effective tool for dealing with temporal data and the role of the forecasting strategy when we move from one-step to multiple-step forecasting.


### Temporal Convolutional Networks (TCN)

* **Forecasting Gold Prices Using Temporal Convolutional Networks**

  * **Summary** Previous attempts at gold price prediction have used a variety of econometric and machine learning techniques. In particular Long Short-Term Networks (LSTMs) and more recently an ensemble of Convolutional Neural Networks (CNNs) and LSTMs have been found to have had considerable level of success in time series prediction. In this research we have conducted a comparative analysis between ARIMA, CNN, LSTM and CNN-LSTM and a recently introduced structure known as Temporal Convolutional Networks (TCNs) on gold price data spanning 20 years. The results show how TCNs produced a RMSE of 15.26 and outperformed both CNN-LSTM and LSTM with RMSE scores of 23.53 and 27.39 respectively.
  * [Link](https://www.sciencedirect.com/science/article/abs/pii/S0957417420303055) - [DB](https://www.dropbox.com/s/wfrurxx7fxqxw5n/Gold%20volatility%20prediction%20using%20a%20CNN-LSTM%20approach.pdf?dl=0)

### Convolutional Neural Networks (CNN)

* **[Paper] CNNpred: CNN-based stock market prediction using a diverse set of variables**

    * [Link](https://www.sciencedirect.com/science/article/abs/pii/S0957417419301915) - [PDF Link](https://www.researchgate.net/profile/Ehsan-Hoseinzade/publication/331911968_CNNpred_CNN-based_stock_market_prediction_using_a_diverse_set_of_variables/links/5cb07442299bf120975fd0fd/CNNpred-CNN-based-stock-market-prediction-using-a-diverse-set-of-variables.pdf) - [DB](https://www.dropbox.com/s/yxhkhukc6x8u7gc/CNNpred%20-%20CNN-based%20stock%20market%20prediction%20using%20a%20diverse%20set%20of%20variables.pdf?dl=0)
    * [Github Repo](https://github.com/hoseinzadeehsan/CNNpred-Keras) - [DB Zip Repo](https://www.dropbox.com/s/ao3wl6vz7d2zf4q/hoseinzadeehsan-CNNpred-Keras-ed6d3a1.zip?dl=0)
    * **Summary** An attempt to classify the next days trading as ”Up” or ”Down” for the S&P500, NASDAQ, DJI, NYSE and RUSSELL stock market indices. The first model, called 2D-CNNPred, used two dimensional inputs that feed images to the CNN containing 60 days time lags and 82 explanatory variables. The second approach known as 3D-CNNPred, adds an additional dimension of features from the five financial indexes that are being predicted. Both models use multiple convolution and pooling layers and then flatten the data, which is fed to a fully-connected layer to produce the final output.

### Train-Test-Validation Split

* **Time Series Nested Cross-Validation**

  * **Summary** This blog post discusses the pitfalls of using traditional cross-validation with time series data. Specifically, we address 1) splitting a time series without causing data leakage, 2) using nested cross-validation to obtain an unbiased estimate of error on an independent test set, and 3) cross-validation with datasets that contain multiple time series.
  * [Link](https://towardsdatascience.com/time-series-nested-cross-validation-76adba623eb9) - [DB](https://www.dropbox.com/s/yae7kf2pvmtxvrv/2022.07.07-time-series-nested-cross-validation-76adba623eb9.pdf?dl=0)

### Getting Data

* **[Colab] Introduction to Stock Analysis**

  * **Summary** Colab notebook with the basics of getting stock data with `pandas_datareader`.
  * [Link](https://colab.research.google.com/github/lucasmoratof/stock_projects/blob/master/Stock_Analysis_Basics.ipynb) - [DB](https://www.dropbox.com/s/5cl3maesz7prou2/2022.07.07-Stock_Analysis_Basics.ipynb%23scrollTo%3DhpGBDjj5X9VZ.pdf?dl=0)

* **Data Scraping in R Programming: Part 2 (Scraping HTML Data) - Analytics Steps**

  * [Link](https://www.analyticssteps.com/blogs/data-scraping-r-programming-part-2-scraping-html-data)

### Amazon Services (AWS)

* **Actions - Amazon Forecast**
  * [Link](https://docs.aws.amazon.com/forecast/latest/dg/API_Operations.html)
* **R User Guide to Amazon SageMaker - Amazon SageMaker**
  * [Link](https://docs.aws.amazon.com/sagemaker/latest/dg/r-guide.html)
* **Create a Notebook Instance - Amazon SageMaker**
  * [Link](https://docs.aws.amazon.com/sagemaker/latest/dg/howitworks-create-ws.html)
* **Time Series Forecasting Service – Amazon Forecast – Amazon Web Services**
  * [Link](https://aws.amazon.com/forecast/#)
* **AWS Classroom Course name: Predict the Future with Time Series
Forecasting and Deep Neural Networks**
  * [Link](https://pages.awscloud.com/rs/112-TZM-766/images/Predict_the_Future_with_Time_Series.pdf)
* **Classroom Training - Learn Cloud Skills from an Instructor - AWS**
  * [Link](https://aws.amazon.com/training/classroom/)
* **AWS Skill Builder - Introduction to Amazon Forecast**
  * [Link](https://explore.skillbuilder.aws/learn/course/external/view/elearning/282/introduction-to-amazon-forecast)
* **Time Series Forecasting Principles with Amazon Forecast - AWS Whitepaper**
  * [Link](https://docs.aws.amazon.com/whitepapers/latest/time-series-forecasting-principles-with-amazon-forecast/time-series-forecasting-principles-with-amazon-forecast.pdf) - [DB](https://www.dropbox.com/s/1lv4uhrmg9e1a3x/time-series-forecasting-principles-with-amazon-forecast.pdf?dl=0)

### Machine Learning in Sports Betting

* **Can We Beat the Bookmaker with Machine Learning? Predicting profitable soccer bets with a LSTM model**
  * [Link](https://towardsdatascience.com/can-we-beat-the-bookmaker-with-machine-learning-45e3b30fc921) - [DB](https://www.dropbox.com/s/wwqfai8va28sysq/Can%20We%20Beat%20the%20Bookmaker%20with%20Machine%20Learning_%20_%20by%20Sebastian%20Guggisberg%20_%20Towards%20Data%20Science.pdf?dl=0)
  * [Github Repo](https://github.com/guggio/soccer_bets/blob/master/BettingBot.ipynb)

# Building a Trading System with Machine Learning Models

## Definitions

* **Target variable** - the variable you want to forecast
* **Explanatory Variable** - variable(s) that explain and forecast the target variable
* Seasonality -
* **Correlation Coefficient** - how much 2 variables are correlated
* **Correlation Matrix** - matrix that contains the correlations between each pair of variables in a dataset
* **Classification** - target variable is categorical (yes/no)
* **Regression** - supervised modeling where target variable is numeric
* **Univariate Model** - Only one target variable is changing over time.
    * In time series analysis, the whole time series is the "variable": a univariate time series is the series of values over time of a single quantity.
    * For example, data collected from a sensor measuring the temperature of a room every second. Therefore, each second, you will only have a one-dimensional value, which is the temperature.
* **Multivariate Time Series** - Multiple related target variables are changing over time.
    * For example, a tri-axial accelerometer. There are three accelerations, one for each axis (x,y,z) and they vary simultaneously over time.
* **N Period(s) Ahead Forecast** the number of time periods ahead to forecast
* **Iterated forecasts** multiperiod ahead time series forecasts are made using a one-period ahead model, iterated forward for the desired number of periods
* **Direct Forecasts** are made using a horizon-specific estimated model, where the dependent variable is the multi-period ahead value being forecasted
* **Recursive** forecasts are based only on values of the series up to the date on which the forecast is made. Parameters are then re-estimated in each period, for each forecasting model, using data from the beginning of the sample through the current forecasting date.  Also called **pseudo-out-of-sample**.

## Univariate Time Series Models

* Time series models are models that make a forecast of a variable by looking only at historical developments of the variable itself.
* Univariate time series models make predictions based on **trends and seasonality observed in their own past** and do not use explanatory variables other than the target variable: the variable that you want to forecast.

## Supervised Machine Learning Models

* Model relationships between explanatory variables and a target variable
* Predictions that you would want to make may be dependent on other, independent sources of information (ie, Explanatory Variables).
* Split into: (1) classification or (2) regression

## Correlations

* A correlation coefficient is always between -1 and 1.
  * A positive value for the correlation coefficient means that two variables are positively correlated: if one is higher, then the other is generally also higher.
  * If the correlation coefficient is negative, there is a negative correlation: if one value is higher, then the other is generally lower. This is the direction of the correlation.

* There is also a notion of the strength of the correlation.
  * A correlation that is close to 1 or close to -1 is strong.
  * A correlation coefficient that is close to 0 is a weak correlation.
* Strong correlations are generally more interesting, as an explanatory variable that strongly correlated to your variable can be used for forecasting it.

## Types of Forecast Models

### Steps to Define a Forecast Model

1. Time Series: Univariate or Multivariate
2. Steps Ahead: 1-step or MultiStep
3. Recursiveness: Iterated or Direct

### Types of Forecast Models

#### 1. Univariate time series + 1-step ahead

* Single time series + 1 period ahead forecast
* A single time series is used to predict one single period into the future. For example, developing a model that uses the last 3 days of the local temperature at 7 a.m. to predict tomorrow's temperature at 7 a.m.
* Example:

```
prediction(t+1) = model1(obs(t-1), obs(t-2), ..., obs(t-n))

# - Example training and testing data:

x_train = c(1,2,3)
y_train = c(4)

x_test = c(4,5,6)
y_test = c(7)
```

#### 2. Univariate time series + Direct N-step ahead

* Single time series + Direct N-step ahead
* Single shot predictions where the entire time series is predicted at once.
* A single time series is used to create a model to predict N-periods into the future. For example, developing a model that uses the last 3 days of the local temperature at 7 a.m. to predict the temperature at 7 a.m. 3 days in the future.
* Example:

```
prediction(t+1) = model1(obs(t-1), obs(t-2), ..., obs(t-n))
prediction(t+2) = model2(obs(t-2), obs(t-3), ..., obs(t-n))

# - Example training and testing data:

x_train = c(1,2,3)
y_train = c(4,5,6)

x_test = c(4,5,6)
y_test = c(7,8,9)

```

* In the example above, `x_train` is used to predict `y_train` without referencing what came before it. Put another way, the model doesn't use the number `4` when it is predicting `5` and `6`; it only "knows" that `[1,2,3]` came before.

#### 3. Univariate time series + Iterated or Recursive N-step ahead

* Single time series + Iterative N-step ahead forecast
* Autoregressive predictions where the model only makes single step predictions and its output is fed back as its input.
* Because predictions are used in place of observations, the recursive strategy allows prediction errors to accumulate such that performance can quickly degrade as the prediction time horizon increases.
* Example:

```
prediction(t+1) = model(obs(t-1), obs(t-2), ..., obs(t-n))
prediction(t+2) = model(prediction(t+1), obs(t-1), ..., obs(t-n))

# - Example training and testing data:

look.ahead.steps = 3

for i in 1:(look.ahead.steps){
	x_train[i] = c(1,2,3)
	y_train[i] = model %>% predict(x_train[i])
	x_train[i] = c(x_train[i], y_train[i])
}
```

#### 4. Multivariate time series + 1-step Ahead

#### 5. Multivariate time series + Direct N-step ahead
* One time series + N-step ahead

#### 6. Multivariate time series + Iterated N-step ahead

## Error and Evaluation of Models

### Metric 1 - MSE

* Mean Squared Error - average of the squared errors
* Error metric --> Smaller the MSE, better the model
* Similar to variance

![](https://images.squarespace-cdn.com/content/v1/5acbdd3a25bf024c12f4c8b4/1600368657769-5BJU5FK86VZ6UXZGRC1M/Mean+Squared+Error.png?format=750w)

### Metric 2 - RMSE

* **Root Mean Squared Error** - square root of the MSE
* Take square root --> same scale as original data
* Error metric --> Smaller the RMSE, better the model
* Similar to Standard Deviation

### Metric 3 - MAE

* **Mean Absolute Error** - the absolute differences between the predicted and actual values per row and then average these differences.

### Metric 4 - MAPE

* **Mean Absolute Percent Error**, is computed by taking the error for each prediction, divided by the actual value. This is done to obtain the errors relative to the actual values. This will make for an error measure as a percentage, and therefore it is standardized.
* Error Metric --> Smaller MAPE, better model
* Convert to goodness of fit by taking 1 - MAPE

### Metric 5 - R-squared

* **R^2 (R-squared)** is a metric that is very close to the 1 – MAPE metric
* performance metric rather than an error metric
* Measured on a scale of 0 to 1 --> 0 is average
* For example, a R2 of 0.4 means it is 40% better than average

## Splitting the Data

### Strategy 1: Train-Test-Split

* A first split that is often deployed is the train-test split. When applying a train-test split, you split the rows of data in two. You would generally keep 20% or 30% of data in a test set.
* You can then proceed to fit models on the rest of the data: the training data.

#### Good v Bad Outcome - Train-Test-Split

* **Good =** Lower Error on training data vs test data
* **Bad =** Higher KPI on training data vs test data (Overfit)
* Minimum 3 observations per period
* Be aware of seasonality

### Strategy 2: Train-Validation-Test Split

* **Model Comparison:** Benchmark performance metrics of many models
* When using the train-validation-test split, you will
  * train models on the training data
  * benchmark the models on the validation data, and this will be the basis for your model selection.
  * use your selected model to compute an error on the test set: this should confirm the estimated error of your model.

#### Good v Bad Outcome - Train-Validation-Test Split

* **Good =** Lower Error on training data vs validation data
* **Bad =** Higher Error on training data vs validation data (bias in error estimate - too few points or overfit)

### Strategy 3: Cross-Validation for Forecasting

#### K-Fold Cross-Validation

* Fit the same model k times, and you evaluate the error each time. You then obtain k error measures, of which you take the average. This is your cross-validation error.
* K - between 3 and 10
* If K = 5 then
  * On those five train-test splits, you train the model on the observations that have been selected as training data
  * compute the error on the observations that have been selected as the test data.
  * The cross-validation error is then the average of the five test errors

![](https://www.researchgate.net/profile/Mariia-Fedotenkova/publication/311668395/figure/fig5/AS:613923871019041@1523382265447/A-schematic-illustration-of-K-fold-cross-validation-for-K-5-Original-dataset-shown.png)

#### Time Series Cross-Validation

* Time series models are generally based on making forecasts based on trends and/or seasonality: they use the past of the target variable to forecast the future.
* **Time Series Split:** take only data that is before the test period for model training.

![](https://miro.medium.com/max/1400/1*5vky1z29e1iO6iOvCTBJxg.png)

#### Rolling Time Series Cross-Validation

* Uses the same period for each fold in the cross-validation.

![](https://thierrymoudiki.github.io/images/2020-03-27/2020-03-27-image1.png)

#### Backtesting

* To evaluate the performances of this strategy, you run the strategy on historical data of stock prices: what would have happened if you had sold and bought stocks at the prices you indicated. Then you evaluate how much profit you would have obtained.
* Library reco: fastquant which is [available on GitHub](https://github.com/enzoampil/fastquant)

### Safe Forecasts with a Multi-Step Strategy

* Train and tune your models using crossvalidation on the training data
* Measure predictive errors on the validation data: the model that has the best error on the validation data will be your preferred model
* Make a prediction on the test data with the selected model, and you make sure that the error is the same as the error observed on the validation data. If this is the case, you can be confident that your model should be delivering the same range of errors on future data.
* Note: you do not always have to obtain the lowest possible Mean Squared Error! Sometimes, stable performances are the most important. Other times, you may want to avoid any overestimation, while underestimations are not a problem (e.g., in a restaurant, it may be worse to buy too much food due to an overestimated demand forecast, rather than too little).


# Notes & Research

## General

* [Mean Square Error & R2 Score Clearly Explained](https://www.bmc.com/blogs/mean-squared-error-r2-and-variance-in-regression-analysis/)
* [What is the difference between univariate and multivariate time series?](https://stats.stackexchange.com/questions/342754/what-is-the-difference-between-univariate-and-multivariate-time-series)


## Training For Error Vs Profit

* backtesting - Lower MSE results in less profit when using Machine Learning - Quantitative Finance Stack Exchange - [Link](https://quant.stackexchange.com/questions/45390/lower-mse-results-in-less-profit-when-using-machine-learning) - [DB](https://www.dropbox.com/s/jrixt4v555n3hwf/PDF%20document.pdf?dl=0)
* The training dilemma: loss vs profit function? | by Haris (Chariton) Chalvatzis | Analytics Vidhya | Medium - [Link](https://medium.com/analytics-vidhya/the-training-dilemma-loss-vs-profit-function-bf98a93cc284) - [DB](https://www.dropbox.com/s/jrixt4v555n3hwf/PDF%20document.pdf?dl=0)

* [Preparing Time Series Data for RNN in Tensorflow | mobiarch](https://mobiarch.wordpress.com/2020/11/13/preparing-time-series-data-for-rnn-in-tensorflow/)
* [time series - LSTM Timeseries recursive prediction converge to same value - Data Science Stack Exchange](https://datascience.stackexchange.com/questions/26639/lstm-timeseries-recursive-prediction-converge-to-same-value)
* [TensorFlow for R - Introduction to Tensors](https://keras.rstudio.com/guides/tensorflow/tensor)
* [TensorFlow for R - Working with RNNs](https://keras.rstudio.com/guides/keras/working_with_rnns)
* [RStudio AI Blog: Convolutional LSTM for spatial forecasting](https://blogs.rstudio.com/ai/posts/2020-12-17-torch-convlstm/)
* [Time-series analysis with smoothed Convolutional Neural Network | Journal of Big Data | Full Text](https://journalofbigdata.springeropen.com/articles/10.1186/s40537-022-00599-y)
* [(PDF) LSTM Fully Convolutional Networks for Time Series Classification](https://www.researchgate.net/publication/319875739_LSTM_Fully_Convolutional_Networks_for_Time_Series_Classification)
* [New Tab](chrome://newtab/)
* [Chapter 13 Deep Learning | Hands-On Machine Learning with R](https://bradleyboehmke.github.io/HOML/deep-learning.html)
* [Time Series Forecasting with Recurrent Neural Networks | R-bloggers](https://www.r-bloggers.com/2017/12/time-series-forecasting-with-recurrent-neural-networks/)
* [RStudio AI Blog: Time Series Forecasting with Recurrent Neural Networks](https://blogs.rstudio.com/ai/posts/2017-12-20-time-series-forecasting-with-recurrent-neural-networks/)
* [Learn by example RNN/LSTM/GRU time series | Kaggle](https://www.kaggle.com/code/charel/learn-by-example-rnn-lstm-gru-time-series/notebook)
* [tensorflow - How to stack multiple lstm in keras? - Stack Overflow](https://stackoverflow.com/questions/40331510/how-to-stack-multiple-lstm-in-keras)
* [A Stacked GRU-RNN-Based Approach for Predicting Renewable Energy and Electricity Load for Smart Grid Operation | IEEE Journals & Magazine | IEEE Xplore](https://ieeexplore.ieee.org/document/9347810)
* [GS - ERC Credit: Todoist](https://todoist.com/app/project/2294492615)
* [2021 - ERC Eligibility & Credit Calculator - Gusto - Google Sheets](https://docs.google.com/spreadsheets/d/1r5lZjFK3rfl8qPPqHsDywBAH2ELbgASRT7euhxgdX9k/edit#gid=1613260222)
* [FAQs: Employee Retention Credit under the CARES Act | Internal Revenue Service](https://www.irs.gov/newsroom/faqs-employee-retention-credit-under-the-cares-act)
* [COVID-19-Related Employee Retention Credits: General Information FAQs | Internal Revenue Service](https://www.irs.gov/newsroom/covid-19-related-employee-retention-credits-general-information-faqs)
* [COVID-19-Related Employee Retention Credits: Determining When an Employer’s Trade or Business Operations are Considered to be Fully or Partially Suspended Due to a Governmental Order FAQs | Internal Revenue Service](https://www.irs.gov/newsroom/covid-19-related-employee-retention-credits-determining-when-an-employers-trade-or-business-operations-are-considered-to-be-fully-or-partially-suspended-due-to-a-governmental-order-faqs)
* [Employer Tax Credits | Internal Revenue Service](https://www.irs.gov/coronavirus/employer-tax-credits#erclimitation)
* [N-2021-20](https://www.irs.gov/pub/irs-drop/n-21-20.pdf)
* [N-2021-23](https://www.irs.gov/pub/irs-drop/n-21-23.pdf)
* [N-2021-49](https://www.irs.gov/pub/irs-drop/n-21-49.pdf)
* [RP-2021-33](https://www.irs.gov/pub/irs-drop/rp-21-33.pdf)
* [Employee Retention Credit for 2020 and 2021 | Gusto](https://gusto.com/blog/taxes/employee-retention-credit)
* [Gusto Login - Payroll, Benefits, HR | Gusto](https://app.gusto.com/login?ia=1&x_role_id=7757869450997147)
* [COVID-19-Related Employee Retention Credits: Determining When an Employer is Considered to have a Significant Decline in Gross Receipts and Maximum Amount of an Eligible Employer’s Employee Retention Credit FAQs | Internal Revenue Service](https://www.irs.gov/newsroom/covid-19-related-employee-retention-credits-determining-when-an-employer-is-considered-to-have-a-significant-decline-in-gross-receipts-and-maximum-amount-of-an-eligible-employers-employee-retention)
* [There are alerts in the main content. Your session has timed out](https://gap.barclaysus.com/servicing/timeout?redirectreasoncode=cstr001&_rnd=1658767183217)
* [Inbox (462) - jake.stoetzner@gmail.com - Gmail](https://mail.google.com/mail/u/0/#inbox)
* [booknotes-advanced-forecasting-with-python.ipynb - Colaboratory](https://colab.research.google.com/drive/1GkquzKKezPZz8PPBYU5Xxw0h2a9RBtVw#scrollTo=clFFMCvXjAyY)
* [notes-LSTM-modeling.ipynb - Colaboratory](https://colab.research.google.com/drive/15_Ryg62AGovtjICbn-8B8bhZzjSZOvlF#scrollTo=ocu_zw4QKi_E&line=1&uniqifier=1)
* [doi:10.1016/j.jeconom.2005.07.020](https://www.princeton.edu/~mwatson/papers/Marcellino_Stock_Watson_JoE_2006.pdf)
* [How To Backtest Machine Learning Models for Time Series Forecasting](https://machinelearningmastery.com/backtest-machine-learning-models-time-series-forecasting/)
* [python - How can i implement multi-step forecasting for my LSTM model in keras? - Stack Overflow](https://stackoverflow.com/questions/71905186/how-can-i-implement-multi-step-forecasting-for-my-lstm-model-in-keras)
* [python - How to use the LSTM model for multi-step forecasting? - Stack Overflow](https://stackoverflow.com/questions/69785891/how-to-use-the-lstm-model-for-multi-step-forecasting)
* [Time Series Prediction in R Keras | Kaggle](https://www.kaggle.com/code/davidchilders/time-series-prediction-in-r-keras/notebook)
* [TensorFlow for R – fit.keras.engine.training.model](https://tensorflow.rstudio.com/reference/keras/fit.keras.engine.training.model)
* [Time Series Forecasting with the Long Short-Term Memory Network in Python](https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/)
* [python - Keras LSTM - Input shape for time series prediction - Stack Overflow](https://stackoverflow.com/questions/57373239/keras-lstm-input-shape-for-time-series-prediction)
* [python - LSTM Nerual Network Input/Output dimensions error - Stack Overflow](https://stackoverflow.com/questions/54139115/lstm-nerual-network-input-output-dimensions-error?rq=1)
* [array function - RDocumentation](https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/array)
* [Search Keras documentation](https://keras.io/search.html?query=input_shape)
* [Conv1D layer](https://keras.io/api/layers/convolution_layers/convolution1d/)
* [Crossway Storage: Rent Roll](https://www.crosswaystorage.com/reports/rent_roll)
